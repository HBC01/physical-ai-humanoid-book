---
title: "Exercise 7: Speech Recognition"
sidebar_label: "Ex 7: Speech Commands"
---

# Exercise 7: Voice-Controlled Robot Commands

## Setup

```bash
pip install speechrecognition pyaudio
```

## Speech Recognition Node

```python
import speech_recognition as sr
import rclpy
from rclpy.node import Node
from std_msgs.msg import String

class SpeechCommandNode(Node):
    def __init__(self):
        super().__init__('speech_command_node')

        self.publisher = self.create_publisher(String, 'voice_commands', 10)
        self.recognizer = sr.Recognizer()
        self.microphone = sr.Microphone()

        self.listen_for_commands()

    def listen_for_commands(self):
        with self.microphone as source:
            self.get_logger().info('Listening for commands...')
            self.recognizer.adjust_for_ambient_noise(source)

            while rclpy.ok():
                try:
                    audio = self.recognizer.listen(source, timeout=5)
                    command = self.recognizer.recognize_google(audio)

                    self.get_logger().info(f'Heard: {command}')

                    msg = String()
                    msg.data = command.lower()
                    self.publisher.publish(msg)

                except sr.UnknownValueError:
                    self.get_logger().warn('Could not understand audio')
                except sr.RequestError as e:
                    self.get_logger().error(f'Recognition error: {e}')
```

## Command Parser

```python
def process_command(command):
    if 'forward' in command:
        return {'linear': 0.5, 'angular': 0.0}
    elif 'backward' in command:
        return {'linear': -0.5, 'angular': 0.0}
    elif 'turn left' in command:
        return {'linear': 0.0, 'angular': 0.5}
    elif 'turn right' in command:
        return {'linear': 0.0, 'angular': -0.5}
    elif 'stop' in command:
        return {'linear': 0.0, 'angular': 0.0}
    return None
```

## Example Commands
- "Move forward"
- "Turn left"
- "Stop"
- "Go to the kitchen"

## Expected Results
- Speech recognized and published to ROS 2 topic
- Robot responds to voice commands
- Works in real-time with low latency
